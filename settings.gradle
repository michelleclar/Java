pluginManagement {
    repositories {
        // mavenLocal()
        maven { url 'https://maven.aliyun.com/repository/central' }
        maven { url 'https://maven.aliyun.com/repository/jcenter' }

        maven { url 'https://maven.aliyun.com/repository/apache-snapshots' }
        maven { url 'https://maven.aliyun.com/repository/gradle-plugin' }
        mavenCentral()
        gradlePluginPortal()
    }
    plugins {
        id 'org.gradle.toolchains.foojay-resolver-convention' version '0.5.0'
        id "${quarkusPluginId}" version "${quarkusPluginVersion}"
        id 'org.kordamp.gradle.jandex' version '1.1.0'
    }
}
dependencyResolutionManagement {
    versionCatalogs {
        libs {
            // versions
            version('quarkus', '3.7.3')
            version('jooq', '3.18.7')
            version('jooqQuarkiverse', '2.0.1')
            version('slf4j-jboss-logmanager', '2.6.1.Final')
            version('testcontainers', '1.19.6')
            version('consul', '2.3.1')
            // NOTE:quarkus
            plugin('quarkusPlugin', 'io.quarkus').versionRef('quarkus')
            library('quarkusPlaform', 'io.quarkus.platform', 'quarkus-bom').versionRef('quarkus')
            library('quarkusSmallryeOpenapi', 'io.quarkus', 'quarkus-smallrye-openapi').versionRef('quarkus')
            library('quarkusArc', 'io.quarkus', 'quarkus-arc').versionRef('quarkus')
            library('quarkusResteasyReactiveJackson', 'io.quarkus', 'quarkus-resteasy-reactive-jackson').versionRef('quarkus')
            library('quarkusJunit5', 'io.quarkus', 'quarkus-junit5').versionRef('quarkus')

            library('flyway', 'io.quarkus', 'quarkus-flyway').versionRef('quarkus')

            // NOTE:slf4j-jboss-logmanager (links quarkus jboss-logging so it can log jOOQs slf4j logging)
            library('slf4jJbossLogmanager', 'org.jboss.slf4j', 'slf4j-jboss-logmanager').versionRef('slf4j-jboss-logmanager')

            // NOTE:vert.x
            library('vertx', 'io.quarkus', 'quarkus-vertx').versionRef('quarkus')
            library('vertxClient', 'io.smallrye.reactive', 'smallrye-mutiny-vertx-web-client').versionRef('quarkus')

            // NOTE:db
            library('agroal', 'io.quarkus', 'quarkus-agroal').versionRef('quarkus')
            library('quarkusJdbcMariadb', 'io.quarkus', 'quarkus-jdbc-mariadb').versionRef('quarkus')
            library('quarkusJdbcMySQL', 'io.quarkus', 'quarkus-jdbc-mysql').versionRef('quarkus')
            library('quarkusJdbcPostgreSQL', 'io.quarkus', 'quarkus-jdbc-postgresql').versionRef('quarkus')

            library('quarkusReactivePgClient', 'io.quarkus', 'quarkus-reactive-pg-client').versionRef('quarkus')
            library('quarkusReactiveMysqlClient', 'io.quarkus', 'quarkus-reactive-mysql-client').versionRef('quarkus')

            library('mongodb', 'io.quarkus', 'quarkus-mongodb-client').versionRef('quarkus')
            library('redis', 'io.quarkus', 'quarkus-redis-client').versionRef('quarkus')

            // NOTE:jooq
            // library('jooq', 'org.jooq', 'jooq').versionRef('jooq')
            library('jooq', 'io.quarkiverse.jooq', 'quarkus-jooq').versionRef('jooqQuarkiverse')
            library('jooqMeta', 'org.jooq', 'jooq-meta').versionRef('jooq')
            library('jooqCodegen', 'org.jooq', 'jooq-codegen').versionRef('jooq')

            // NOTE:consul
            library('consul', 'io.quarkiverse.config', 'quarkus-config-consul').versionRef('consul')
            library('consulStork', 'io.smallrye.stork', 'stork-service-discovery-consul').versionRef('quarkus')
            library('consulClient', 'io.smallrye.reactive', 'smallrye-mutiny-vertx-consul-client').versionRef('quarkus')
            library('pulsar', 'io.quarkus', 'quarkus-smallrye-reactive-messaging-pulsar').versionRef('quarkus')
            library('gRPC', 'io.quarkus', 'quarkus-grpc').versionRef('quarkus')

            // NOTE:testcontainers
            library('testcontainers', 'org.testcontainers', 'testcontainers').versionRef('testcontainers')
            library('testcontainersPg', 'org.testcontainers', 'postgresql').versionRef('testcontainers')
            library('testcontainersJunitJupiter', 'org.testcontainers', 'junit-jupiter').versionRef('testcontainers')

            library('assured', 'io.rest-assured', 'rest-assured').versionRef('quarkus')


            // NOTE:bundles
            bundle('quarkus', ['quarkusResteasyReactiveJackson', 'quarkusArc', 'quarkusJunit5'])

            bundle('jooq', ['jooq', 'jooqMeta', 'jooqCodegen'])

            bundle('vertx', ['vertx', 'vertxClient'])
            bundle('postgresql', ['quarkusJdbcPostgreSQL', 'quarkusReactivePgClient'])

            // TODO:consul ---> kubernetes
            bundle('base', ['quarkusJdbcPostgreSQL', 'quarkusReactivePgClient', 'agroal', 'vertx', 'vertxClient', 'mongodb', 'redis', 'jooq', 'jooqMeta', 'jooqCodegen', 'slf4jJbossLogmanager', 'consulStork', 'consulClient','gRPC'])

            bundle('allJdbc',  ['quarkusJdbcMariadb', 'quarkusJdbcMySQL', 'quarkusJdbcPostgreSQL'])
            bundle('allDBReactiveClient', ['quarkusReactivePgClient', 'quarkusReactiveMysqlClient'])

            bundle('testcontainers', ['testcontainers', 'testcontainersPg'])

            bundle('test', ['testcontainers', 'testcontainersPg', 'flyway', 'assured', 'quarkusJunit5'])
            // test-bundles
            bundle('test.quarkus', ['quarkusJunit5',  'quarkusJdbcPostgreSQL', 'quarkusResteasyReactiveJackson', 'quarkusSmallryeOpenapi', 'quarkusArc', ])
            bundle('test.testcontainers', ['testcontainers', 'testcontainersPg', 'testcontainersJunitJupiter'])
        }
    }
}
rootProject.name = 'Java'
// include 'code-with-quarkus'
include 'demo'
include 'common'
